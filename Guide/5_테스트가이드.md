# EmoLamp 전체 테스트 가이드

## 1. 단계별 테스트 순서

```
[1단계] Arduino 단독 테스트
    ↓
[2단계] Unity 단독 테스트 (API)
    ↓
[3단계] Unity + Arduino 연동 테스트
    ↓
[4단계] Cloudtype 서버 테스트
    ↓
[5단계] 전체 시스템 통합 테스트
    ↓
[6단계] 시연 리허설
```

---

## 1단계: Arduino 단독 테스트

### 1.1 코드 업로드

1. Arduino IDE 실행
2. `EmoLamp.ino` 파일 열기
3. **도구 → 보드 → Arduino Mega or Mega 2560**
4. **도구 → 포트 → COM3** (실제 포트 선택)
5. **업로드** 버튼 클릭

### 1.2 Serial Monitor 테스트

1. **도구 → Serial Monitor** 열기
2. **Baud rate: 9600** 설정
3. **예상 출력:**
   ```
   STATUS:OK
   EmoLamp Arduino Ready
   LIGHT:45
   LIGHT:47
   ...
   ```

### 1.3 LED 테스트

**Serial Monitor에서 명령 입력:**

```
RGB:255,0,0      → 빨간색
RGB:0,255,0      → 초록색
RGB:0,0,255      → 파란색
RGB:255,255,0    → 노란색
RGB:255,255,255  → 흰색
RGB:0,0,0        → 꺼짐
```

**확인:**
```
□ 각 색상이 올바르게 표시됨
□ 색상 전환이 즉시 됨
□ DEBUG 메시지 출력됨
```

### 1.4 조도 센서 테스트

```
1. 밝은 환경: LIGHT:70~100 출력
2. 손으로 가림: LIGHT:20~40 출력
3. 완전히 가림: LIGHT:0~20 출력
```

**확인:**
```
□ 조도값이 주기적으로 출력됨 (0.5초마다)
□ 밝기에 따라 값이 변함
□ 급격한 변화에 반응함
```

### 1.5 Arduino 테스트 체크리스트

```
□ Serial 통신 정상
□ LED 빨강 테스트 OK
□ LED 초록 테스트 OK
□ LED 파랑 테스트 OK
□ LED 혼합색 테스트 OK
□ 조도 센서 반응 OK
```

---

## 2단계: Unity 단독 테스트 (API)

### 2.1 Serial 비활성화

**테스트를 위해 임시로:**
- SerialController의 `Auto Connect` 체크 해제
- 또는 SerialController 오브젝트 비활성화

### 2.2 날씨 API 테스트

1. Unity Play 모드 실행
2. **Console 확인:**
   ```
   [WeatherManager] 날씨 정보 요청: Seoul
   [WeatherManager] 응답: {"coord":...}
   [WeatherManager] 날씨 파싱 완료: 8°C, Clouds, 구름 조금
   ```

**문제 시:**
```
- API 키 확인
- 인터넷 연결 확인
- HTTP 허용 설정 확인
```

### 2.3 Claude API 테스트

1. 입력창에 "오늘 기분 좋아" 입력
2. "분석" 버튼 클릭
3. **Console 확인:**
   ```
   [ClaudeManager] 감정 분석 시작: 오늘 기분 좋아
   [ClaudeManager] 응답: {"id":"msg_...
   [ClaudeManager] 감정 분석 완료: Joy (H:50)
   ```

**문제 시:**
```
- API 키 확인
- 요청 JSON 형식 확인
- 응답 파싱 로그 확인
```

### 2.4 Papago API 테스트

1. 입력창에 "I'm feeling happy" 입력
2. "분석" 버튼 클릭
3. **Console 확인:**
   ```
   [PapagoManager] 언어 감지: en
   [PapagoManager] 번역 요청: [en→ko] I'm feeling happy
   [PapagoManager] 번역 완료: 나는 행복해
   [ClaudeManager] 감정 분석 시작: 나는 행복해
   ```

**문제 시:**
```
- Client ID / Secret 확인
- 네이버 개발자센터에서 API 상태 확인
```

### 2.5 Firebase 테스트

1. Unity Play 모드에서 분석 실행
2. **Firebase Console 확인:**
   - https://console.firebase.google.com/
   - Realtime Database → emolamp/state
   - 데이터가 저장되었는지 확인

3. **Firebase에서 직접 수정:**
   - `mode` 값을 "MANUAL"로 변경
   - Unity에서 반영되는지 확인

### 2.6 Unity 단독 테스트 체크리스트

```
□ 날씨 API 정상 동작
□ Claude API 정상 동작
□ Papago API 정상 동작 (영어 입력 시)
□ Firebase 저장 정상
□ Firebase 원격 변경 감지
□ UI 업데이트 정상
□ HSV 색상 계산 정상
□ 3D 램프 색상 변경 정상
```

---

## 3단계: Unity + Arduino 연동 테스트

### 3.1 Arduino 연결

1. Arduino IDE의 Serial Monitor **닫기** (중요!)
2. Unity에서 SerialController `Auto Connect` 체크
3. Play 모드 실행

### 3.2 연결 확인

**Console:**
```
[SerialController] 연결 성공: COM3
```

**연결 안 될 때:**
```
1. COM 포트 번호 확인
2. Arduino IDE Serial Monitor 닫혔는지 확인
3. USB 케이블 확인
4. Unity 재시작
```

### 3.3 조도 → Unity 테스트

1. **조도 센서를 손으로 가림**
2. **확인:**
   ```
   [SerialController] 수신: LIGHT:25
   [BackgroundController] 밝기 설정: 25%
   [HSVController] Brightness 설정: 37.5% (조도)
   ```
3. **Unity 배경이 어두워지는지 확인**

### 3.4 Unity → LED 테스트

1. 입력창에 "화가 나" 입력
2. "분석" 버튼 클릭
3. **확인:**
   ```
   [ClaudeManager] 감정 분석 완료: Anger (H:0)
   [HSVController] Hue 설정: 0° (감정)
   [LampController] 램프 색상 적용: RGB(255,0,0)
   [SerialController] 전송: RGB:255,0,0
   ```
4. **물리 LED가 빨간색으로 변하는지 확인**

### 3.5 MANUAL 모드 테스트

1. **MANUAL 토글 클릭**
2. **색상 슬라이더 조작**
3. **확인:**
   - Unity 3D 램프 색상 즉시 변경
   - 물리 LED 색상 즉시 변경
   - 두 색상이 동일함

### 3.6 연동 테스트 체크리스트

```
□ Serial 연결 성공
□ 조도 센서 → Unity 배경 연동
□ 조도 센서 → HSV Brightness 연동
□ Claude 분석 → Unity LED 색상
□ Claude 분석 → 물리 LED 색상
□ MANUAL 모드 Unity LED
□ MANUAL 모드 물리 LED
□ Unity와 물리 LED 동기화
```

---

## 4단계: Cloudtype 서버 테스트

### 4.1 서버 상태 확인

**브라우저에서:**
```
https://YOUR_URL.cloudtype.app/api/status
```

**예상 응답:**
```json
{
  "status": "ok",
  "server": "EmoLamp Server",
  "version": "1.0.0"
}
```

### 4.2 curl 테스트

```bash
# 상태 업데이트
curl -X POST https://YOUR_URL.cloudtype.app/api/state \
  -H "Content-Type: application/json" \
  -d '{"mode":"MANUAL","manualColorHex":"#FF00FF"}'

# 상태 조회
curl https://YOUR_URL.cloudtype.app/api/state
```

### 4.3 Unity MQTT 연동

1. MQTTManager의 `Server Url` 설정
2. Play 모드 실행
3. **Console 확인:**
   ```
   [MQTTManager] 서버 연결 시도: https://...
   [MQTTManager] 서버 연결 성공
   ```

### 4.4 서버 테스트 체크리스트

```
□ 서버 상태 확인 OK
□ 상태 조회 API OK
□ 상태 업데이트 API OK
□ Unity MQTT 연결 OK
```

---

## 5단계: 전체 시스템 통합 테스트

### 5.1 전체 흐름 테스트

```
[테스트 1] 텍스트 분석 → LED

1. Unity Play 모드 실행
2. "오늘 정말 좋은 하루야" 입력
3. "분석" 버튼 클릭

확인:
□ Claude 분석 완료 (Console)
□ UI에 감정 표시 (😊 기쁨)
□ UI에 요약 표시
□ Unity 3D 램프 색상 변경 (골드)
□ 물리 LED 색상 변경 (골드)
□ Firebase에 상태 저장
```

```
[테스트 2] 다국어 → 번역 → 분석

1. "I'm feeling blue today" 입력
2. "분석" 버튼 클릭

확인:
□ Papago 번역 (→ "오늘 우울해")
□ Claude 분석 (슬픔)
□ LED 색상 변경 (파랑)
```

```
[테스트 3] 날씨 연동

1. 날씨 API 자동 로드 확인
2. 날씨 상태에 따른 채도 변화 확인

확인:
□ 날씨 정보 UI 표시
□ 맑음 → 채도 높음
□ 흐림 → 채도 낮음
```

```
[테스트 4] 조도 연동

1. 조도 센서 가리기
2. 배경 + LED 밝기 변화 확인

확인:
□ Unity 배경 어두워짐
□ LED 색상 어두워짐 (명도↓)
□ 센서 열면 다시 밝아짐
```

```
[테스트 5] MANUAL 모드

1. MANUAL 토글 클릭
2. 슬라이더로 색상 조정

확인:
□ Color Picker 표시
□ 슬라이더 조작 → 즉시 반영
□ Unity LED = 물리 LED
```

```
[테스트 6] Firebase 원격 제어

1. Firebase Console에서 직접 수정
   - emolamp/state/mode → "MANUAL"
   - emolamp/state/manualColorHex → "#FF0000"

2. Unity에서 변화 확인

확인:
□ Unity가 MANUAL 모드로 전환
□ LED가 빨간색으로 변경
```

### 5.2 통합 테스트 체크리스트

```
□ 텍스트 → Claude → LED 정상
□ 다국어 → Papago → Claude → LED 정상
□ 날씨 → 채도 연동 정상
□ 조도 → 명도 연동 정상
□ MANUAL 모드 정상
□ Firebase 양방향 동기화 정상
□ MQTT 서버 연동 정상
```

---

## 6단계: 시연 리허설

### 6.1 시연 스크립트 (2분 30초)

```
[0:00-0:20] 인트로
"AI 감정 조명 EmoLamp입니다.
색감은 감정, 채도는 날씨, 명도는 조도로 제어됩니다."

[0:20-0:50] AUTO 모드 데모
1. "오늘 기분 좋아" 입력
2. 분석 버튼 클릭
3. "기쁨 분석 → 골드색" 설명
4. Unity + 물리 LED 동시 변화 확인

[0:50-1:10] 다국어 데모
1. "I'm feeling sad" 입력
2. "영어 → 한국어 번역 → 분석"
3. LED 파란색 변화

[1:10-1:30] 조도 연동
1. 조도 센서 손으로 가림
2. "물리 환경이 어두워지면..."
3. Unity 배경 + LED 어두워짐

[1:30-2:00] MANUAL 모드
1. MANUAL 토글 클릭
2. 슬라이더 조작
3. "직접 색상 제어"
4. Unity + 물리 LED 동시 변화

[2:00-2:20] Firebase 원격
1. 폰으로 Firebase Console 접속
2. 색상 값 변경
3. "어디서든 원격 제어"

[2:20-2:30] 마무리
"5개 API와 HSV 모델로 구현한 EmoLamp였습니다.
감사합니다."
```

### 6.2 리허설 체크리스트

```
□ 모든 시스템 정상 작동
□ 시연 순서 숙지
□ 예상 질문 답변 준비
□ 백업 계획 (API 실패 시)
□ 타이밍 연습 (2분 30초)
```

### 6.3 비상 대응 계획

```
[Serial 연결 실패]
→ "하드웨어 연결 문제로 소프트웨어 데모만 진행하겠습니다"
→ Unity 3D 램프만으로 시연

[API 실패]
→ 미리 저장된 결과 활용
→ "네트워크 상황으로 캐시된 결과를 보여드립니다"

[Firebase 느림]
→ MANUAL 모드로 전환
→ "실시간 동기화는 네트워크 상황에 따라 지연될 수 있습니다"
```

---

## 7. 최종 체크리스트

### 발표 전날

```
□ 모든 API 키 유효 확인
□ Firebase 데이터베이스 초기화
□ Cloudtype 서버 정상 확인
□ Arduino 배터리/전원 확인
□ USB 케이블 여분 준비
□ 노트북 충전 완료
```

### 발표 당일

```
□ 일찍 도착하여 셋업
□ Serial 포트 확인
□ 인터넷 연결 확인
□ 전체 시스템 한 번 테스트
□ Serial Monitor 닫기!
□ 발표 준비 완료
```

---

## 8. 완료!

모든 테스트를 통과했다면 EmoLamp 시스템이 완성된 것입니다! 🎉

```
✅ Arduino 하드웨어 작동
✅ Unity 소프트웨어 작동
✅ API 연동 (Claude, Papago, Weather, Firebase)
✅ MQTT 서버 작동
✅ 양방향 동기화 작동
✅ 시연 준비 완료
```

발표 성공을 응원합니다! 🚀
